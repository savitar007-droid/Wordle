<!DOCTYPE html>
<html>
<head>
    <title>Wordle</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Reset default margin */
        body h1:not(.header-center h1) {
            display: none; /* Hide only the duplicate h1 outside header */
        }

        /* Header Styles */
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 20px;
            border-bottom: 1px solid #d3d6da;
            background: white;
            position: sticky;
            top: 0;
            z-index: 1000;
            width: 100%;
            position: relative; /* For absolute positioning of center */
        }

        .header-left,
        .header-right {
            display: flex;
            gap: 8px;
            align-items: center;
            min-width: 200px; /* Ensure space for buttons */
        }

        .header-left {
            justify-content: flex-start;
        }

        .header-right {
            justify-content: flex-end;
        }

        .header-center {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .header-center h1 {
            display: none; /* Hide text, show tiles instead */
        }

        /* Animated Wordle Logo */
        .wordle-logo {
            display: flex;
            gap: 4px;
        }

        .logo-tile {
            width: 40px;
            height: 40px;
            border: 2px solid #d3d6da;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            color: white;
            animation: flip 4s infinite ease-in-out;
            transform-style: preserve-3d;
            cursor: pointer;
        }

        /* Pause animation on hover */
        .wordle-logo:hover .logo-tile {
            animation-play-state: paused;
        }

        .logo-tile:nth-child(1) {
            animation-delay: 0s;
            background: #6aaa64;
        }

        .logo-tile:nth-child(2) {
            animation-delay: 0.5s;
            background: #c9b458;
        }

        .logo-tile:nth-child(3) {
            animation-delay: 1s;
            background: #6aaa64;
        }

        .logo-tile:nth-child(4) {
            animation-delay: 1.5s;
            background: #c9b458;
        }

        .logo-tile:nth-child(5) {
            animation-delay: 2s;
            background: #6aaa64;
        }

        .logo-tile:nth-child(6) {
            animation-delay: 2.5s;
            background: #787c7e;
        }

        @keyframes flip {
            0%, 100% {
                transform: rotateX(0deg);
            }
            50% {
                transform: rotateX(180deg);
            }
        }

        /* Lower the Change Mode button */
        #top-controls {
            margin-top: 20px;
        }

        .icon-btn {
            width: 40px;
            height: 40px;
            border: none;
            background: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: background 0.2s;
        }

        .icon-btn:hover {
            background: #f0f0f0;
        }

        .icon-btn svg {
            width: 24px;
            height: 24px;
        }

        .icon-btn.hint-btn {
            background: #f9f9f9;
            border: 1px solid #d3d6da;
        }

        .icon-btn.hint-btn:hover {
            background: #e8e8e8;
        }

        /* Menu Modal */
        .menu-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 2000;
        }

        .menu-modal.active {
            display: block;
        }

        .menu-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 280px;
            height: 100%;
            background: white;
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.1);
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }

        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid #e0e0e0;
        }

        .menu-header h2 {
            margin: 0;
            font-size: 20px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #666;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .menu-items {
            padding: 8px 0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 14px 20px;
            cursor: pointer;
            transition: background 0.2s;
            text-decoration: none;
            color: #121212;
        }

        .menu-item:hover {
            background: #f5f5f5;
        }

        .menu-item svg {
            width: 22px;
            height: 22px;
            margin-right: 14px;
        }

        .menu-divider {
            height: 1px;
            background: #e0e0e0;
            margin: 8px 0;
        }

        .user-info-menu {
            padding: 16px 20px;
            background: #f9f9f9;
            border-bottom: 1px solid #e0e0e0;
        }

        .user-info-menu strong {
            color: #6aaa64;
        }

        /* Help Modal */
        .help-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }

        .help-modal.active {
            display: flex;
        }

        .help-content {
            background: white;
            padding: 32px;
            border-radius: 8px;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .help-content h2 {
            margin-top: 0;
        }
    </style>
</head>
<body>

<!-- Header -->
<header class="game-header">
    <div class="header-left">
        <button class="icon-btn" onclick="toggleMenu()" title="Menu">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
            </svg>
        </button>
    </div>

    <div class="header-center">
        <h1 style="display: none;">Wordle</h1> <!-- Hidden duplicate title -->
    </div>

    <div class="header-center">
        <h1>Wordle</h1>
        <div class="wordle-logo">
            <div class="logo-tile">W</div>
            <div class="logo-tile">O</div>
            <div class="logo-tile">R</div>
            <div class="logo-tile">D</div>
            <div class="logo-tile">L</div>
            <div class="logo-tile">E</div>
        </div>
    </div>

    <div class="header-right">
        <button class="icon-btn hint-btn" onclick="goToHints()" title="Get hints">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>
            </svg>
        </button>

        <button class="icon-btn" onclick="showHelp()" title="How to play">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/>
            </svg>
        </button>

        <button class="icon-btn" id="statsBtn" onclick="goToStats()" title="Statistics">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M16,11V3H8v6H2v12h20V11H16z M10,5h4v14h-4V5z M4,11h4v8H4V11z M20,19h-4v-6h4V19z"/>
            </svg>
        </button>

        <button class="icon-btn" onclick="openSettings()" title="Settings">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
            </svg>
        </button>
    </div>
</header>

<!-- Menu Modal -->
<div class="menu-modal" id="menuModal" onclick="closeMenuOnBackdrop(event)">
    <div class="menu-content">
        <div class="menu-header">
            <h2>Menu</h2>
            <button class="close-btn" onclick="toggleMenu()">&times;</button>
        </div>

        <!-- User Info (if logged in) -->
        <div id="userInfoMenu" class="user-info-menu" style="display: none;">
            Logged in as <strong id="menuUsername"></strong>
        </div>

        <div class="menu-items">
            <!-- Login/Register (shown when NOT logged in) -->
            <a href="/login" class="menu-item" id="menuLogin">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M11 7L9.6 8.4l2.6 2.6H2v2h10.2l-2.6 2.6L11 17l5-5-5-5zm9 12h-8v2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-8v2h8v14z"/>
                </svg>
                Login / Register
            </a>

            <!-- Stats (shown when logged in) -->
            <a href="/statistics" class="menu-item" id="menuStats" style="display: none;">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M16,11V3H8v6H2v12h20V11H16z M10,5h4v14h-4V5z M4,11h4v8H4V11z M20,19h-4v-6h4V19z"/>
                </svg>
                View Statistics
            </a>

            <div class="menu-divider"></div>

            <a href="/help" class="menu-item">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/>
                </svg>
                How to Play
            </a>

            <a href="/leaderboard" class="menu-item">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M16 11V3H8v6H2v12h20V11h-6zm-6-6h4v14h-4V5zM4 11h4v8H4v-8zm16 8h-4v-6h4v6z"/>
                </svg>
                Leaderboard
            </a>

            <div class="menu-divider"></div>

            <!-- Logout (shown when logged in) -->
            <a href="#" class="menu-item" id="menuLogout" style="display: none;" onclick="logout(event)">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5-5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
                </svg>
                Logout
            </a>
        </div>
    </div>
</div>

<!-- Help Modal -->
<div class="help-modal" id="helpModal" onclick="closeHelpOnBackdrop(event)">
    <div class="help-content">
        <button class="close-btn" onclick="closeHelp()" style="position: absolute; top: 8px; right: 8px;">&times;</button>
        <h2>How To Play</h2>
        <p>Guess the Wordle in 6 tries.</p>
        <p>Each guess must be a valid 5-letter word. Hit the enter button to submit.</p>
        <p>After each guess, the color of the tiles will change to show how close your guess was to the word.</p>
        <div style="margin: 20px 0;">
            <p><strong>Examples</strong></p>
            <p style="margin-top: 10px;">
                <span style="display: inline-block; width: 40px; height: 40px; background: #6aaa64; color: white; text-align: center; line-height: 40px; font-weight: bold; margin-right: 4px;">W</span>
                <span>The letter W is in the word and in the correct spot.</span>
            </p>
            <p style="margin-top: 10px;">
                <span style="display: inline-block; width: 40px; height: 40px; background: #c9b458; color: white; text-align: center; line-height: 40px; font-weight: bold; margin-right: 4px;">I</span>
                <span>The letter I is in the word but in the wrong spot.</span>
            </p>
            <p style="margin-top: 10px;">
                <span style="display: inline-block; width: 40px; height: 40px; background: #787c7e; color: white; text-align: center; line-height: 40px; font-weight: bold; margin-right: 4px;">U</span>
                <span>The letter U is not in the word in any spot.</span>
            </p>
        </div>
        <button onclick="closeHelp()" style="padding: 12px 24px; background: #6aaa64; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">Got it!</button>
    </div>
</div>

<h1>Wordle</h1>

<!-- TOP CONTROLS -->
<div id="top-controls">
    <button id="change-mode" onclick="openModeModal()">Change Mode</button>
    <div id="timer"></div>
</div>

<!-- MODE SELECTION MODAL -->
<div id="mode-modal">
    <div id="mode-box">
        <h2>Select Game Mode</h2>
        <button onclick="startGame('normal')">Normal</button>
        <button onclick="startGame('time')">60s Time Mode</button>
        <button onclick="startGame('sudden')">Sudden Death</button>
    </div>
</div>

<!-- WIN MODAL -->
<div id="win-modal" style="display:none;">
    <div id="win-box">
        <h2>ðŸŽ‰ Congratulations!</h2>
        <p id="win-text"></p>

        <p class="cta">
            To track your stats and compete with other players,<br>
            <strong>Login / Register yourself</strong>
        </p>

        <div class="win-actions">
            <button onclick="redirectToAuth()">Login / Register</button>
            <button class="secondary" onclick="closeWinModal()">Close</button>
        </div>
    </div>
</div>

<div id="board"></div>
<div id="keyboard"></div>
<div id="toast"></div>

<script src="script.js" defer></script>
<script>
    // Menu functions
    function toggleMenu() {
        const modal = document.getElementById('menuModal');
        modal.classList.toggle('active');

        // Update menu based on login status
        updateMenuItems();
    }

    function updateMenuItems() {
        const user = localStorage.getItem('user');

        if (user) {
            // User is logged in
            document.getElementById('userInfoMenu').style.display = 'block';
            document.getElementById('menuUsername').textContent = user;
            document.getElementById('menuLogin').style.display = 'none';
            document.getElementById('menuStats').style.display = 'flex';
            document.getElementById('menuLogout').style.display = 'flex';
        } else {
            // User is NOT logged in
            document.getElementById('userInfoMenu').style.display = 'none';
            document.getElementById('menuLogin').style.display = 'flex';
            document.getElementById('menuStats').style.display = 'none';
            document.getElementById('menuLogout').style.display = 'none';
        }
    }

    function closeMenuOnBackdrop(event) {
        if (event.target.id === 'menuModal') {
            toggleMenu();
        }
    }

    function showHelp() {
        document.getElementById('helpModal').classList.add('active');
    }

    function closeHelp() {
        document.getElementById('helpModal').classList.remove('active');
    }

    function closeHelpOnBackdrop(event) {
        if (event.target.id === 'helpModal') {
            closeHelp();
        }
    }

    function goToStats() {
        const user = localStorage.getItem('user');
        if (user) {
            window.location.href = '/statistics';
        } else {
            alert('Please login to view statistics!');
            window.location.href = '/login';
        }
    }

    function openSettings() {
        alert('Settings coming soon!');
    }

    function logout(event) {
        event.preventDefault();
        if (confirm('Are you sure you want to logout?')) {
            localStorage.removeItem('user');
            window.location.replace('/');
        }
    }

    // Hint functionality - Navigate to hints page
    function goToHints() {
        // Save current game state before leaving
        if (typeof saveGameState === 'function') {
            saveGameState();
        }
        window.location.href = '/hints';
    }

    // Initialize menu on page load
    document.addEventListener('DOMContentLoaded', function() {
        updateMenuItems();
    });
</script>

</body>
</html>